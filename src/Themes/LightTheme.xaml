<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <!-- Light Theme Color Definitions (matching ColorScheme.CreateLightDefault) -->
    <SolidColorBrush x:Key="ThemeBackgroundBrush" Color="#FFFFFF"/>          <!-- 255,255,255 -->
    <SolidColorBrush x:Key="ThemeSecondaryBackgroundBrush" Color="#F8F9FA"/>  <!-- Secondary bg for code blocks, etc -->
    <SolidColorBrush x:Key="ThemeForegroundBrush" Color="#212529"/>           <!-- 33,37,41 -->
    <SolidColorBrush x:Key="ThemeAccentBrush" Color="#66B3FF"/>               <!-- 0,102,204 -->
    <SolidColorBrush x:Key="ThemeBorderBrush" Color="#DEE2E6"/>               <!-- 222,226,230 -->
    <SolidColorBrush x:Key="ThemeButtonBackgroundBrush" Color="#F8F9FA"/>     <!-- 248,249,250 -->
    <SolidColorBrush x:Key="ThemeButtonHoverBrush" Color="#E9ECEF"/>          <!-- 233,236,239 -->
    <SolidColorBrush x:Key="ThemeSidebarBackgroundBrush" Color="#F8F9FA"/>    <!-- 248,249,250 -->
    <SolidColorBrush x:Key="ThemeTabActiveBrush" Color="#FFFFFF"/>            <!-- 255,255,255 -->
    <SolidColorBrush x:Key="ThemeTabInactiveBrush" Color="#F8F9FA"/>          <!-- 248,249,250 -->

    <!-- Light Theme Text Colors -->
    <SolidColorBrush x:Key="ThemeTextPrimaryBrush" Color="#212529"/>          <!-- Matches Foreground -->
    <SolidColorBrush x:Key="ThemeTextSecondaryBrush" Color="#6B7280"/>
    <SolidColorBrush x:Key="ThemeTextMutedBrush" Color="#9CA3AF"/>
    <SolidColorBrush x:Key="ThemeTextLinkBrush" Color="#66B3FF"/>             <!-- Matches Accent -->

    <!-- Light Theme Input Controls -->
    <SolidColorBrush x:Key="ThemeInputBackgroundBrush" Color="#FFFFFF"/>
    <SolidColorBrush x:Key="ThemeInputBorderBrush" Color="#DEE2E6"/>          <!-- Matches Border -->
    <SolidColorBrush x:Key="ThemeInputFocusBrush" Color="#66B3FF"/>           <!-- Matches Accent -->
    
    <!-- Additional theme brushes for consistency -->
    <SolidColorBrush x:Key="ThemeSecondaryForegroundBrush" Color="#6B7280"/>
    <SolidColorBrush x:Key="ThemeSelectionBrush" Color="#DBEAFE"/>
    
    <!-- Aliases for backward compatibility -->
    <SolidColorBrush x:Key="SurfaceBackground" Color="#FFFFFF"/>
    <SolidColorBrush x:Key="SurfaceSecondary" Color="#F8F9FA"/>
    <SolidColorBrush x:Key="BorderColor" Color="#DEE2E6"/>
    <SolidColorBrush x:Key="TextPrimary" Color="#212529"/>

    <!-- Light Theme Status Colors -->
    <SolidColorBrush x:Key="ThemeSuccessBrush" Color="#16A34A"/>
    <SolidColorBrush x:Key="ThemeWarningBrush" Color="#EAB308"/>
    <SolidColorBrush x:Key="ThemeErrorBrush" Color="#DC2626"/>
    <SolidColorBrush x:Key="ThemeInfoBrush" Color="#0EA5E9"/>
    
    <!-- Light Theme File Tree Icon Colors -->
    <SolidColorBrush x:Key="ThemeFolderIconBrush" Color="#60A5FA"/>
    <SolidColorBrush x:Key="ThemeFileIconBrush" Color="#9CA3AF"/>

    <!-- Typography System -->
    
    <!-- Font Families -->
    <FontFamily x:Key="ThemeFontFamily">Segoe UI, system-ui, sans-serif</FontFamily>
    <FontFamily x:Key="ThemeMonoFontFamily">Consolas, 'Courier New', monospace</FontFamily>
    
    <!-- Font Sizes -->
    <sys:Double x:Key="FontSizeXs">11</sys:Double>
    <sys:Double x:Key="FontSizeSm">12</sys:Double>
    <sys:Double x:Key="FontSizeBase">14</sys:Double>
    <sys:Double x:Key="FontSizeLg">16</sys:Double>
    <sys:Double x:Key="FontSizeXl">18</sys:Double>
    <sys:Double x:Key="FontSize2xl">20</sys:Double>
    <sys:Double x:Key="FontSize3xl">24</sys:Double>
    <sys:Double x:Key="FontSize4xl">32</sys:Double>
    
    <!-- Line Heights -->
    <sys:Double x:Key="LineHeightTight">1.25</sys:Double>
    <sys:Double x:Key="LineHeightSnug">1.375</sys:Double>
    <sys:Double x:Key="LineHeightNormal">1.5</sys:Double>
    <sys:Double x:Key="LineHeightRelaxed">1.625</sys:Double>
    <sys:Double x:Key="LineHeightLoose">2.0</sys:Double>
    
    <!-- Typography Styles -->
    
    <!-- Heading Styles -->
    <Style x:Key="Heading1" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSize4xl}"/>
        <Setter Property="FontWeight" Value="Bold"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="LineHeight" Value="38"/>
        <Setter Property="Margin" Value="0,0,0,16"/>
    </Style>
    
    <Style x:Key="Heading2" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSize3xl}"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="LineHeight" Value="32"/>
        <Setter Property="Margin" Value="0,0,0,12"/>
    </Style>
    
    <Style x:Key="Heading3" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSize2xl}"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="LineHeight" Value="28"/>
        <Setter Property="Margin" Value="0,0,0,8"/>
    </Style>
    
    <Style x:Key="Heading4" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeXl}"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="LineHeight" Value="24"/>
        <Setter Property="Margin" Value="0,0,0,8"/>
    </Style>
    
    <!-- Body Text Styles -->
    <Style x:Key="BodyLarge" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeLg}"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="LineHeight" Value="24"/>
        <Setter Property="Margin" Value="0,0,0,12"/>
    </Style>
    
    <Style x:Key="BodyBase" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeBase}"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="LineHeight" Value="21"/>
        <Setter Property="Margin" Value="0,0,0,12"/>
    </Style>
    
    <Style x:Key="BodySmall" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeSm}"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextSecondaryBrush}"/>
        <Setter Property="LineHeight" Value="18"/>
        <Setter Property="Margin" Value="0,0,0,8"/>
    </Style>
    
    <!-- Specialized Text Styles -->
    <Style x:Key="Caption" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeXs}"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextMutedBrush}"/>
        <Setter Property="LineHeight" Value="16"/>
        <Setter Property="Margin" Value="0,0,0,4"/>
    </Style>
    
    <Style x:Key="Label" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeSm}"/>
        <Setter Property="FontWeight" Value="Medium"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="LineHeight" Value="18"/>
        <Setter Property="Margin" Value="0,0,0,4"/>
    </Style>
    
    <Style x:Key="Code" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeMonoFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeSm}"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="Background" Value="{StaticResource ThemeSecondaryBackgroundBrush}"/>
        <Setter Property="Padding" Value="4,2"/>
        <Setter Property="LineHeight" Value="18"/>
    </Style>
    
    <!-- Link Style -->
    <Style x:Key="Link" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeBase}"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextLinkBrush}"/>
        <Setter Property="TextDecorations" Value="Underline"/>
        <Setter Property="Cursor" Value="Hand"/>
    </Style>

    <!-- Light Theme Control Styles -->
    
    <!-- Window Style -->
    <Style x:Key="LightThemeWindow" TargetType="{x:Type Window}">
        <Setter Property="Background" Value="{StaticResource ThemeBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource ThemeBorderBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- Button Style -->
    <Style x:Key="LightThemeButton" TargetType="{x:Type Button}">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeBase}"/>
        <Setter Property="FontWeight" Value="Medium"/>
        <Setter Property="Background" Value="{StaticResource ThemeButtonBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource ThemeBorderBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="12,8"/>
        <Setter Property="Margin" Value="2"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="6">
                        <ContentPresenter x:Name="contentPresenter"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          Margin="{TemplateBinding Padding}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeBorderBrush}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Navigation Bar Button Styles -->
    
    <!-- Navigation Button Style (back/forward/search/export) -->
    <Style x:Key="NavigationButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderThickness="0"
                            CornerRadius="4"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeBorderBrush}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.4"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Window Control Button Style (minimize/maximize) -->
    <Style x:Key="WindowControlButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderThickness="0"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeBorderBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Close Button Style (red hover) -->
    <Style x:Key="CloseButtonStyle" TargetType="{x:Type Button}" BasedOn="{StaticResource WindowControlButtonStyle}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderThickness="0"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#DC2626"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#B91C1C"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Tab Styling -->
    
    <!-- Tab Scroll Button Style (left/right/new) -->
    <Style x:Key="TabScrollButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderThickness="0"
                            CornerRadius="4"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeBorderBrush}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Opacity" Value="0.3"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Tab Close Button Style (Ã— button on tabs) -->
    <Style x:Key="TabCloseButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextSecondaryBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderThickness="0"
                            CornerRadius="3"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#DC2626"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#B91C1C"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- TextBox Style -->
    <Style x:Key="LightThemeTextBox" TargetType="{x:Type TextBox}">
        <Setter Property="FontFamily" Value="{StaticResource ThemeFontFamily}"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeBase}"/>
        <Setter Property="Background" Value="{StaticResource ThemeInputBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource ThemeInputBorderBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="8,6"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="6">
                        <ScrollViewer x:Name="PART_ContentHost"
                                      Margin="{TemplateBinding Padding}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsFocused" Value="True">
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource ThemeInputFocusBrush}"/>
                            <Setter TargetName="border" Property="BorderThickness" Value="2"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ListBox Style -->
    <Style x:Key="LightThemeListBox" TargetType="{x:Type ListBox}">
        <Setter Property="Background" Value="{StaticResource ThemeBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource ThemeBorderBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <!-- ListBoxItem Style -->
    <Style x:Key="LightThemeListBoxItem" TargetType="{x:Type ListBoxItem}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="Padding" Value="8,4"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeAccentBrush}"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- TreeView Style -->
    <Style x:Key="LightThemeTreeView" TargetType="{x:Type TreeView}">
        <Setter Property="Background" Value="{StaticResource ThemeSidebarBackgroundBrush}"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource ThemeBorderBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <!-- TreeViewItem Style -->
    <Style x:Key="LightThemeTreeViewItem" TargetType="{x:Type TreeViewItem}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeForegroundBrush}"/>
        <Setter Property="Padding" Value="4,2"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TreeViewItem}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Border x:Name="border"
                                Grid.Row="0"
                                Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter x:Name="PART_Header"
                                              ContentSource="Header"/>
                        </Border>
                        <ItemsPresenter x:Name="ItemsHost"
                                        Grid.Row="1"
                                        Margin="16,0,0,0"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeAccentBrush}"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsExpanded" Value="False">
                            <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- TabControl Style -->
    <Style x:Key="LightThemeTabControl" TargetType="{x:Type TabControl}">
        <Setter Property="Background" Value="{StaticResource ThemeBackgroundBrush}"/>
        <Setter Property="BorderBrush" Value="{StaticResource ThemeBorderBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabControl}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Tab Headers -->
                        <TabPanel Grid.Row="0"
                                  IsItemsHost="True"
                                  Background="Transparent"
                                  Margin="8,4,8,0"/>
                        
                        <!-- Tab Content -->
                        <Border Grid.Row="1"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter ContentSource="SelectedContent"/>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- TabItem Style -->
    <Style x:Key="LightThemeTabItem" TargetType="{x:Type TabItem}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextSecondaryBrush}"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0,0,0,2"/>
        <Setter Property="Padding" Value="12,10,12,8"/>
        <Setter Property="Margin" Value="0,0,1,0"/>
        <Setter Property="FontSize" Value="{StaticResource FontSizeSm}"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="MinHeight" Value="36"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabItem}">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            Margin="{TemplateBinding Margin}"
                            CornerRadius="0">
                        <ContentPresenter x:Name="contentPresenter"
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Center"
                                          ContentSource="Header"
                                          TextBlock.Foreground="{TemplateBinding Foreground}"
                                          TextBlock.FontWeight="{TemplateBinding FontWeight}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
                            <Setter Property="FontWeight" Value="Medium"/>
                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource ThemeAccentBrush}"/>
                            <Setter Property="Panel.ZIndex" Value="1"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="True"/>
                                <Condition Property="IsMouseOver" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="border" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Menu Style -->
    <Style x:Key="LightThemeMenu" TargetType="{x:Type Menu}">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
    </Style>

    <!-- MenuItem Style with proper template for top-level and submenu items -->
    <Style x:Key="LightThemeMenuItem" TargetType="{x:Type MenuItem}">
        <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type MenuItem}">
                    <Border x:Name="templateRoot"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="True">
                        <Grid Margin="-1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup"/>
                                <ColumnDefinition Width="13"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="30"/>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup"/>
                                <ColumnDefinition Width="20"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Icon placeholder -->
                            <ContentPresenter x:Name="Icon"
                                              Grid.Column="0"
                                              Width="16" Height="16"
                                              Margin="3"
                                              VerticalAlignment="Center"
                                              ContentSource="Icon"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            
                            <!-- Checkmark (for checkable items) -->
                            <Border x:Name="GlyphPanel"
                                    Grid.Column="0"
                                    Width="16" Height="16"
                                    Margin="3"
                                    Background="Transparent"
                                    BorderBrush="Transparent"
                                    BorderThickness="1"
                                    VerticalAlignment="Center"
                                    Visibility="Hidden">
                                <Path x:Name="Glyph"
                                      Data="M0,5.1 L1.7,3.4 L5.2,7 L14.3,0 L16,1.7 L5.2,12.6 z"
                                      Fill="{StaticResource ThemeTextPrimaryBrush}"
                                      FlowDirection="LeftToRight"
                                      Width="12" Height="12"/>
                            </Border>
                            
                            <!-- Header text -->
                            <ContentPresenter x:Name="menuHeaderContainer"
                                              Grid.Column="2"
                                              HorizontalAlignment="Left"
                                              VerticalAlignment="Center"
                                              ContentSource="Header"
                                              RecognizesAccessKey="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            
                            <!-- Input gesture text (e.g., "Ctrl+O") -->
                            <TextBlock x:Name="menuGestureText"
                                       Grid.Column="4"
                                       Margin="5,2,2,2"
                                       VerticalAlignment="Center"
                                       Foreground="{StaticResource ThemeTextSecondaryBrush}"
                                       Text="{TemplateBinding InputGestureText}"
                                       Opacity="0.7"/>
                            
                            <!-- Submenu arrow -->
                            <Path x:Name="RightArrow"
                                  Grid.Column="5"
                                  Margin="10,0,0,0"
                                  VerticalAlignment="Center"
                                  Data="M0,0 L4,3.5 L0,7 Z"
                                  Fill="{StaticResource ThemeTextPrimaryBrush}"/>
                            
                            <!-- Submenu popup -->
                            <Popup x:Name="PART_Popup"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                   Placement="Bottom"
                                   PopupAnimation="Fade"
                                   VerticalOffset="-1">
                                <Border x:Name="SubMenuBorder"
                                        Background="{StaticResource ThemeBackgroundBrush}"
                                        BorderBrush="{StaticResource ThemeBorderBrush}"
                                        BorderThickness="1"
                                        Padding="2">
                                    <ScrollViewer x:Name="SubMenuScrollViewer"
                                                  Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                        <Grid RenderOptions.ClearTypeHint="Enabled">
                                            <Canvas Width="0" Height="0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Top">
                                                <Rectangle x:Name="OpaqueRect"
                                                           Width="{Binding ActualWidth, ElementName=SubMenuBorder}"
                                                           Height="{Binding ActualHeight, ElementName=SubMenuBorder}"
                                                           Fill="{Binding Background, ElementName=SubMenuBorder}"/>
                                            </Canvas>
                                            <ItemsPresenter x:Name="ItemsPresenter"
                                                            KeyboardNavigation.DirectionalNavigation="Cycle"
                                                            Grid.IsSharedSizeScope="True"
                                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                            KeyboardNavigation.TabNavigation="Cycle"/>
                                        </Grid>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <!-- Top-level item (no role) -->
                        <Trigger Property="Role" Value="TopLevelHeader">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="BorderBrush" Value="Transparent"/>
                            <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
                            <Setter Property="Padding" Value="8,6"/>
                            <Setter TargetName="templateRoot" Property="CornerRadius" Value="4"/>
                            <Setter TargetName="RightArrow" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="GlyphPanel" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="menuGestureText" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="PART_Popup" Property="Placement" Value="Bottom"/>
                        </Trigger>
                        
                        <!-- Top-level item (no children) -->
                        <Trigger Property="Role" Value="TopLevelItem">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="BorderBrush" Value="Transparent"/>
                            <Setter Property="Foreground" Value="{StaticResource ThemeTextPrimaryBrush}"/>
                            <Setter Property="Padding" Value="8,6"/>
                            <Setter TargetName="templateRoot" Property="CornerRadius" Value="4"/>
                            <Setter TargetName="RightArrow" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
                            <Setter TargetName="GlyphPanel" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        
                        <!-- Submenu header (has children) -->
                        <Trigger Property="Role" Value="SubmenuHeader">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Padding" Value="8,6"/>
                            <Setter TargetName="RightArrow" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="PART_Popup" Property="Placement" Value="Right"/>
                            <Setter TargetName="PART_Popup" Property="HorizontalOffset" Value="-2"/>
                            <Setter TargetName="PART_Popup" Property="VerticalOffset" Value="-3"/>
                        </Trigger>
                        
                        <!-- Submenu item (no children) -->
                        <Trigger Property="Role" Value="SubmenuItem">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Padding" Value="8,6"/>
                            <Setter TargetName="RightArrow" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        
                        <!-- Hover effect for top-level items -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Role" Value="TopLevelHeader"/>
                                <Condition Property="IsHighlighted" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="templateRoot" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </MultiTrigger>
                        
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Role" Value="TopLevelItem"/>
                                <Condition Property="IsHighlighted" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="templateRoot" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </MultiTrigger>
                        
                        <!-- Hover effect for submenu items -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Role" Value="SubmenuHeader"/>
                                <Condition Property="IsHighlighted" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="templateRoot" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </MultiTrigger>
                        
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="Role" Value="SubmenuItem"/>
                                <Condition Property="IsHighlighted" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="templateRoot" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </MultiTrigger>
                        
                        <!-- Open submenu styling -->
                        <Trigger Property="IsSubmenuOpen" Value="True">
                            <Setter TargetName="templateRoot" Property="Background" Value="{StaticResource ThemeButtonHoverBrush}"/>
                        </Trigger>
                        
                        <!-- Disabled state -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="templateRoot" Property="Opacity" Value="0.5"/>
                        </Trigger>
                        
                        <!-- Checkable item -->
                        <Trigger Property="Icon" Value="{x:Null}">
                            <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                        
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="GlyphPanel" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <!-- Separator style for menu items -->
    <Style x:Key="LightThemeSeparator" TargetType="{x:Type Separator}">
        <Setter Property="Background" Value="{StaticResource ThemeBorderBrush}"/>
        <Setter Property="Height" Value="1"/>
        <Setter Property="Margin" Value="8,4"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Separator}">
                    <Border Background="{TemplateBinding Background}"
                            Height="{TemplateBinding Height}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>