<UserControl x:Class="MarkRead.App.UI.Shell.NavigationBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:MarkRead.App.UI.Shell"
             xmlns:start="clr-namespace:MarkRead.App.UI.Start"
             mc:Ignorable="d"
             d:DesignHeight="48" Height="48"
             Background="{DynamicResource ThemeSecondaryBackgroundBrush}">
    
    <!-- Local Resources for Menu Styling -->
    <UserControl.Resources>
        <!-- Implicit style for all MenuItems in this control that dynamically updates with theme -->
        <Style TargetType="{x:Type MenuItem}">
            <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimaryBrush}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Grid>
                            <Border x:Name="templateRoot"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    SnapsToDevicePixels="True">
                                <Grid>
                                    <!-- Simple content presenter for top-level items -->
                                    <ContentPresenter x:Name="simpleHeaderContainer"
                                                      ContentSource="Header"
                                                      RecognizesAccessKey="True"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                      Margin="{TemplateBinding Padding}"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      Visibility="Collapsed"/>
                                    
                                    <!-- Complex grid for submenu items -->
                                    <Grid x:Name="complexGrid" Margin="-1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup"/>
                                            <ColumnDefinition Width="13"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup"/>
                                            <ColumnDefinition Width="20"/>
                                        </Grid.ColumnDefinitions>
                                    
                                    <!-- Icon placeholder -->
                                    <ContentPresenter x:Name="Icon"
                                                      Grid.Column="0"
                                                      Width="16" Height="16"
                                                      Margin="3"
                                                      VerticalAlignment="Center"
                                                      ContentSource="Icon"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                
                                <!-- Checkmark (for checkable items) -->
                                <Border x:Name="GlyphPanel"
                                        Grid.Column="0"
                                        Width="16" Height="16"
                                        Margin="3"
                                        Background="Transparent"
                                        BorderBrush="Transparent"
                                        BorderThickness="1"
                                        VerticalAlignment="Center"
                                        Visibility="Hidden">
                                    <Path x:Name="Glyph"
                                          Data="M0,5.1 L1.7,3.4 L5.2,7 L14.3,0 L16,1.7 L5.2,12.6 z"
                                          Fill="{DynamicResource ThemeTextPrimaryBrush}"
                                          FlowDirection="LeftToRight"
                                          Width="12" Height="12"/>
                                </Border>
                                
                                <!-- Header text -->
                                <ContentPresenter x:Name="menuHeaderContainer"
                                                  Grid.Column="2"
                                                  HorizontalAlignment="Left"
                                                  VerticalAlignment="Center"
                                                  ContentSource="Header"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                
                                <!-- Input gesture text (e.g., "Ctrl+O") -->
                                <TextBlock x:Name="menuGestureText"
                                           Grid.Column="4"
                                           Margin="5,2,2,2"
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource ThemeTextSecondaryBrush}"
                                           Text="{TemplateBinding InputGestureText}"
                                           Opacity="0.7"/>
                                
                                <!-- Submenu arrow -->
                                <Path x:Name="RightArrow"
                                      Grid.Column="5"
                                      Margin="10,0,0,0"
                                      VerticalAlignment="Center"
                                      Data="M0,0 L4,3.5 L0,7 Z"
                                      Fill="{DynamicResource ThemeTextPrimaryBrush}"/>
                                </Grid>
                            </Grid>
                        </Border>
                            
                            <!-- Submenu popup - outside border for proper placement -->
                            <Popup x:Name="PART_Popup"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                   Placement="Bottom"
                                   PlacementTarget="{Binding ElementName=templateRoot}"
                                   StaysOpen="False">
                                <Border x:Name="SubMenuBorder"
                                        Background="{DynamicResource ThemeBackgroundBrush}"
                                        BorderBrush="{DynamicResource ThemeBorderBrush}"
                                        BorderThickness="1"
                                        Padding="4"
                                        CornerRadius="4"
                                        Effect="{DynamicResource MenuDropShadow}">
                                    <ScrollViewer Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                        <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Cycle"
                                                        Grid.IsSharedSizeScope="True"
                                                        KeyboardNavigation.TabNavigation="Cycle"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <!-- Top-level item (no role) -->
                            <Trigger Property="Role" Value="TopLevelHeader">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="BorderBrush" Value="Transparent"/>
                                <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimaryBrush}"/>
                                <Setter Property="Padding" Value="8,4"/>
                                <Setter TargetName="templateRoot" Property="CornerRadius" Value="4"/>
                                <Setter TargetName="simpleHeaderContainer" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="complexGrid" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="PART_Popup" Property="Placement" Value="Bottom"/>
                                <Setter TargetName="PART_Popup" Property="HorizontalOffset" Value="0"/>
                                <Setter TargetName="PART_Popup" Property="VerticalOffset" Value="2"/>
                            </Trigger>
                            
                            <!-- Top-level item (no children) -->
                            <Trigger Property="Role" Value="TopLevelItem">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="BorderBrush" Value="Transparent"/>
                                <Setter Property="Foreground" Value="{DynamicResource ThemeTextPrimaryBrush}"/>
                                <Setter Property="Padding" Value="8,4"/>
                                <Setter TargetName="templateRoot" Property="CornerRadius" Value="4"/>
                                <Setter TargetName="simpleHeaderContainer" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="complexGrid" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                            
                            <!-- Submenu header (has children) -->
                            <Trigger Property="Role" Value="SubmenuHeader">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Padding" Value="8,6,40,6"/>
                                <Setter TargetName="RightArrow" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="PART_Popup" Property="Placement" Value="Right"/>
                                <Setter TargetName="PART_Popup" Property="HorizontalOffset" Value="-2"/>
                                <Setter TargetName="PART_Popup" Property="VerticalOffset" Value="-3"/>
                            </Trigger>
                            
                            <!-- Submenu item (no children) -->
                            <Trigger Property="Role" Value="SubmenuItem">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Padding" Value="8,6,40,6"/>
                                <Setter TargetName="RightArrow" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                            
                            <!-- Hover effect for top-level items -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="Role" Value="TopLevelHeader"/>
                                    <Condition Property="IsHighlighted" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="templateRoot" Property="Background" Value="{DynamicResource ThemeButtonHoverBrush}"/>
                            </MultiTrigger>
                            
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="Role" Value="TopLevelItem"/>
                                    <Condition Property="IsHighlighted" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="templateRoot" Property="Background" Value="{DynamicResource ThemeButtonHoverBrush}"/>
                            </MultiTrigger>
                            
                            <!-- Hover effect for submenu items -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="Role" Value="SubmenuHeader"/>
                                    <Condition Property="IsHighlighted" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="templateRoot" Property="Background" Value="{DynamicResource ThemeButtonHoverBrush}"/>
                            </MultiTrigger>
                            
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="Role" Value="SubmenuItem"/>
                                    <Condition Property="IsHighlighted" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="templateRoot" Property="Background" Value="{DynamicResource ThemeButtonHoverBrush}"/>
                            </MultiTrigger>
                            
                            <!-- Open submenu styling -->
                            <Trigger Property="IsSubmenuOpen" Value="True">
                                <Setter TargetName="templateRoot" Property="Background" Value="{DynamicResource ThemeButtonHoverBrush}"/>
                            </Trigger>
                            
                            <!-- Disabled state -->
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="templateRoot" Property="Opacity" Value="0.5"/>
                            </Trigger>
                            
                            <!-- Checkable item -->
                            <Trigger Property="Icon" Value="{x:Null}">
                                <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                            
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="GlyphPanel" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Separator style -->
        <Style TargetType="{x:Type Separator}">
            <Setter Property="Background" Value="{DynamicResource ThemeBorderBrush}"/>
            <Setter Property="Height" Value="1"/>
            <Setter Property="Margin" Value="8,4,4,4"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Separator}">
                        <Border Background="{TemplateBinding Background}"
                                Height="{TemplateBinding Height}"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Drop shadow effect for menu popups -->
        <DropShadowEffect x:Key="MenuDropShadow" 
                          BlurRadius="8" 
                          ShadowDepth="2" 
                          Direction="270" 
                          Color="#40000000" 
                          Opacity="0.3"/>
    </UserControl.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <!-- Left section: Navigation controls -->
            <ColumnDefinition Width="Auto"/>
            <!-- Middle section: File path display -->
            <ColumnDefinition Width="*"/>
            <!-- Right section: Actions and window controls -->
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- Left Section: Menu + Title + Navigation Buttons -->
        <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="12,0,0,0" VerticalAlignment="Center">
            <!-- Sidebar Toggle Button (32x32px) -->
            <Button x:Name="MenuButton"
                    Click="MenuButton_Click"
                    Width="32" Height="32"
                    Margin="2,0"
                    Style="{DynamicResource NavigationButtonStyle}"
                    ToolTip="Toggle Sidebar"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <Path Data="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" 
                      Fill="{DynamicResource ThemeTextPrimaryBrush}"
                      Stretch="Uniform"
                      Width="16" Height="16"/>
            </Button>

            <!-- Menu Bar -->
            <Menu Background="Transparent"
                  VerticalAlignment="Center"
                  Margin="8,0,0,0"
                  WindowChrome.IsHitTestVisibleInChrome="True">
                
                <!-- File Menu -->
                <MenuItem Header="_File">
                    <MenuItem Header="Open _Folder..." 
                              Command="{x:Static start:StartCommands.OpenFolder}"
                              InputGestureText="Ctrl+O"/>
                    <MenuItem Header="Open F_ile..." 
                              Command="{x:Static start:StartCommands.OpenFile}"
                              InputGestureText="Ctrl+Shift+O"/>
                    <Separator/>
                    <MenuItem Header="_Close Tab" 
                              InputGestureText="Ctrl+W"
                              IsEnabled="False"/>
                    <Separator/>
                    <MenuItem Header="_Settings..." 
                              Click="SettingsMenuItem_Click"
                              InputGestureText="Ctrl+,"/>
                    <Separator/>
                    <MenuItem Header="E_xit" 
                              Click="ExitMenuItem_Click"
                              InputGestureText="Alt+F4"/>
                </MenuItem>
                
                <!-- Edit Menu -->
                <MenuItem Header="_Edit">
                    <MenuItem Header="_Find..." 
                              Command="{x:Static local:NavigationCommands.Find}"
                              InputGestureText="Ctrl+F"/>
                    <Separator/>
                    <MenuItem Header="Zoom _In" 
                              Click="ZoomIn_Click"
                              InputGestureText="Ctrl++"/>
                    <MenuItem Header="Zoom _Out" 
                              Click="ZoomOut_Click"
                              InputGestureText="Ctrl+-"/>
                    <MenuItem Header="_Reset Zoom" 
                              Click="ResetZoom_Click"
                              InputGestureText="Ctrl+0"/>
                    <MenuItem Header="_Fit to Width" 
                              Click="FitToWidth_Click"
                              InputGestureText="Ctrl+W"/>
                    <Separator/>
                    <MenuItem Header="Go _Back" 
                              Command="{x:Static local:NavigationCommands.GoBack}"
                              InputGestureText="Alt+Left"/>
                    <MenuItem Header="Go _Forward" 
                              Command="{x:Static local:NavigationCommands.GoForward}"
                              InputGestureText="Alt+Right"/>
                </MenuItem>
                
                <!-- Help Menu -->
                <MenuItem Header="_Help">
                    <MenuItem Header="_Keyboard Shortcuts" 
                              Click="ShowKeyboardShortcuts_Click"
                              InputGestureText="F1"/>
                </MenuItem>
            </Menu>

            <!-- Separator (only show when file is active) -->
            <Border x:Name="NavSeparator"
                    Width="1" Height="24"
                    Background="{DynamicResource ThemeBorderBrush}"
                    Margin="4,0">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding CurrentFilePath}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding CurrentFilePath}" Value="">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
            </Border>

            <!-- Back Button (32x32px as per mockup) -->
            <Button x:Name="BackButton"
                    Command="{x:Static local:NavigationCommands.GoBack}"
                    Width="32" Height="32"
                    Margin="2,0"
                    Style="{DynamicResource NavigationButtonStyle}"
                    ToolTip="Go Back (Alt+Left)"
                    IsEnabled="{Binding CanGoBack}"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <Path Data="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" 
                      Fill="{DynamicResource ThemeTextPrimaryBrush}"
                      Stretch="Uniform"
                      Width="16" Height="16"/>
            </Button>

            <!-- Forward Button (32x32px as per mockup) -->
            <Button x:Name="ForwardButton"
                    Command="{x:Static local:NavigationCommands.GoForward}"
                    Width="32" Height="32"
                    Margin="2,0"
                    Style="{DynamicResource NavigationButtonStyle}"
                    ToolTip="Go Forward (Alt+Right)"
                    IsEnabled="{Binding CanGoForward}"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <Path Data="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" 
                      Fill="{DynamicResource ThemeTextPrimaryBrush}"
                      Stretch="Uniform"
                      Width="16" Height="16"/>
            </Button>
        </StackPanel>

        <!-- Middle Section: File Path Display or Application Title -->
        <Grid Grid.Column="1" 
              Margin="12,0"
              Background="Transparent"
              VerticalAlignment="Center">
            <!-- File Path (shown when file is selected) -->
            <TextBlock x:Name="FilePathText"
                       Text="{Binding CurrentFilePath, FallbackValue=''}"
                       Foreground="{DynamicResource ThemeTextSecondaryBrush}"
                       FontSize="12"
                       VerticalAlignment="Center"
                       TextTrimming="CharacterEllipsis"
                       TextAlignment="Center"
                       HorizontalAlignment="Center"
                       MaxWidth="600"
                       ToolTip="{Binding CurrentFilePath}">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding CurrentFilePath}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding CurrentFilePath}" Value="">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
            
            <!-- Application Title (shown when no file is selected) -->
            <TextBlock Text="MarkRead - Markdown Viewer"
                       FontSize="14"
                       Foreground="{DynamicResource ThemeTextPrimaryBrush}"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center"
                       TextAlignment="Center">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding CurrentFilePath}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding CurrentFilePath}" Value="">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
        </Grid>


        <!-- Right Section: Actions and Window Controls -->
        <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,0,0" VerticalAlignment="Center">
            <!-- Search Button (32x32px) -->
            <Button x:Name="SearchButton"
                    Click="SearchButton_Click"
                    Width="32" Height="32"
                    Margin="2,0"
                    Style="{DynamicResource NavigationButtonStyle}"
                    ToolTip="Find in Document (Ctrl+F)"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <Path Data="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" 
                      Fill="{DynamicResource ThemeTextPrimaryBrush}"
                      Stretch="Uniform"
                      Width="16" Height="16"/>
            </Button>

            <!-- Export Dropdown Button (32x32px) -->
            <Button x:Name="ExportButton"
                    Click="ExportButton_Click"
                    Width="32" Height="32"
                    Margin="2,0"
                    Style="{DynamicResource NavigationButtonStyle}"
                    ToolTip="Export Options"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <Path Data="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z" 
                      Fill="{DynamicResource ThemeTextPrimaryBrush}"
                      Stretch="Uniform"
                      Width="16" Height="16"/>
            </Button>

            <!-- Theme Toggle Button (32x32px) -->
            <Button x:Name="ThemeToggleButton"
                    Click="ThemeToggleButton_Click"
                    Width="32" Height="32"
                    Margin="2,0"
                    Style="{DynamicResource NavigationButtonStyle}"
                    ToolTip="Toggle Theme"
                    WindowChrome.IsHitTestVisibleInChrome="True">
                <!-- Sun icon (default for dark mode - shows what clicking will switch to) -->
                <Path x:Name="ThemeIcon"
                      Data="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4zM13 1h-2v3h2V1zm0 19h-2v3h2v-3zM4 13H1v-2h3v2zm19 0h-3v-2h3v2zm-2.1-7.5L19.5 4.1l-1.4 1.4 1.4 1.4 1.4-1.4zM6.3 17.8L4.9 19.2l-1.4-1.4 1.4-1.4 1.4 1.4zM19.5 19.2l-1.4-1.4-1.4 1.4 1.4 1.4 1.4-1.4zM6.3 6.3L4.9 4.9 6.3 3.5 7.7 4.9 6.3 6.3z" 
                      Fill="{DynamicResource ThemeTextPrimaryBrush}"
                      Stretch="Uniform"
                      Width="16" Height="16"/>
            </Button>

            <!-- Separator -->
            <Border Width="1" Height="24" 
                    Background="{DynamicResource ThemeBorderBrush}"
                    Margin="8,0"/>

            <!-- Window Control Buttons (48x48px to match mockup height) -->
            <StackPanel Orientation="Horizontal">
                <!-- Minimize Button -->
                <Button x:Name="MinimizeButton"
                        Click="MinimizeButton_Click"
                        Width="48" Height="48"
                        Margin="0"
                        Style="{DynamicResource WindowControlButtonStyle}"
                        ToolTip="Minimize"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                    <Path Data="M19 13H5v-2h14v2z" 
                          Fill="{DynamicResource ThemeTextPrimaryBrush}"
                          Stretch="Uniform"
                          Width="12" Height="12"/>
                </Button>

                <!-- Maximize/Restore Button -->
                <Button x:Name="MaximizeButton"
                        Click="MaximizeButton_Click"
                        Width="48" Height="48"
                        Margin="0"
                        Style="{DynamicResource WindowControlButtonStyle}"
                        ToolTip="Maximize"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                    <Path x:Name="MaximizeIcon"
                          Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z" 
                          Fill="{DynamicResource ThemeTextPrimaryBrush}"
                          Stretch="Uniform"
                          Width="12" Height="12"/>
                </Button>

                <!-- Close Button -->
                <Button x:Name="CloseButton"
                        Click="CloseButton_Click"
                        Width="48" Height="48"
                        Margin="0"
                        Style="{DynamicResource CloseButtonStyle}"
                        ToolTip="Close"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                    <Path Data="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" 
                          Fill="{DynamicResource ThemeTextPrimaryBrush}"
                          Stretch="Uniform"
                          Width="14" Height="14"/>
                </Button>
            </StackPanel>
        </StackPanel>
    </Grid>
</UserControl>
