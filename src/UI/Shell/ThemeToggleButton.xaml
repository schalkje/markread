<UserControl x:Class="MarkRead.UI.Shell.ThemeToggleButton"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="32" d:DesignWidth="32">
    
    <UserControl.Resources>
        <!-- Theme Toggle Button Style -->
        <Style x:Key="ThemeToggleButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="ToolTip" Value="Toggle theme"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Name="Border" 
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Content="{TemplateBinding Content}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" 
                                        Value="{DynamicResource ButtonHoverBackground}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Border" Property="Background" 
                                        Value="{DynamicResource ButtonPressedBackground}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Light Theme Icon Path -->
        <StreamGeometry x:Key="LightThemeIcon">
            M12,18C11.11,18 10.26,17.8 9.5,17.45C8.74,17.1 8.1,16.63 7.59,16.04C7.08,15.45 6.7,14.76 6.46,14C6.22,13.23 6.1,12.4 6.1,11.5C6.1,10.59 6.22,9.76 6.46,9C6.7,8.24 7.08,7.55 7.59,6.96C8.1,6.37 8.74,5.9 9.5,5.55C10.26,5.2 11.11,5 12,5C12.89,5 13.74,5.2 14.5,5.55C15.26,5.9 15.9,6.37 16.41,6.96C16.92,7.55 17.3,8.24 17.54,9C17.78,9.76 17.9,10.59 17.9,11.5C17.9,12.4 17.78,13.23 17.54,14C17.3,14.76 16.92,15.45 16.41,16.04C15.9,16.63 15.26,17.1 14.5,17.45C13.74,17.8 12.89,18 12,18M12,2L13.09,5.26L16.35,4.17L15.26,7.43L18.5,8.5L15.26,9.57L16.35,12.83L13.09,11.74L12,15L10.91,11.74L7.65,12.83L8.74,9.57L5.5,8.5L8.74,7.43L7.65,4.17L10.91,5.26L12,2Z
        </StreamGeometry>

        <!-- Dark Theme Icon Path -->
        <StreamGeometry x:Key="DarkThemeIcon">
            M12,2A7,7 0 0,1 19,9A7,7 0 0,1 12,16A7,7 0 0,1 5,9A7,7 0 0,1 12,2M12,4A5,5 0 0,0 7,9A5,5 0 0,0 12,14A5,5 0 0,0 17,9A5,5 0 0,0 12,4M12.5,8L16,12H13V16H11V12H8L11.5,8H12.5Z
        </StreamGeometry>

        <!-- System Theme Icon Path -->
        <StreamGeometry x:Key="SystemThemeIcon">
            M4,6H20V16H4M20,18A2,2 0 0,0 22,16V6C22,4.89 21.1,4 20,4H4C2.89,4 2,4.89 2,6V16A2,2 0 0,0 4,18H0V20H24V18H20Z
        </StreamGeometry>
    </UserControl.Resources>

    <Grid>
        <Button Name="ThemeToggleBtn" 
                Style="{StaticResource ThemeToggleButtonStyle}"
                Click="ThemeToggleBtn_Click">
            <Path Name="ThemeIcon" 
                  Data="{StaticResource SystemThemeIcon}"
                  Fill="{DynamicResource ForegroundBrush}" 
                  Stretch="Uniform"
                  Width="16" 
                  Height="16">
                <Path.RenderTransform>
                    <RotateTransform x:Name="IconRotateTransform" CenterX="8" CenterY="8"/>
                </Path.RenderTransform>
            </Path>
        </Button>

        <!-- Animation for theme switching -->
        <Grid.Resources>
            <Storyboard x:Key="ThemeSwitchAnimation">
                <DoubleAnimation Storyboard.TargetName="IconRotateTransform"
                                 Storyboard.TargetProperty="Angle"
                                 From="0" To="360" 
                                 Duration="0:0:0.3"
                                 EasingFunction="{StaticResource {x:Static SystemParameters.MenuPopupAnimationKey}}"/>
            </Storyboard>
        </Grid.Resources>
    </Grid>
</UserControl>